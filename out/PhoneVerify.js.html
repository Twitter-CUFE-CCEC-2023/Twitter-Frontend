<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: PhoneVerify.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: PhoneVerify.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useEffect, useState } from "react";
import { NavLink } from "react-router-dom";
import classes from "./PhoneVerify.module.css";
import ClearIcon from "@material-ui/icons/Clear";
import SignUp from "./Buttons/PasswordNext";
import twitterBlueLogo from "../../../Assets/twitterBlueLogo.png";
import InputField from "../InputField";
import Alert from "./Alert/Alert";
import axios from "../../axios";

const Verify = (props) => {
  const [CODE, setCODE] = useState();
  /**
     * Sets the verification code that the user received in his email in its respective InputField into the variable CODE
     * @function handleCODEChange
     * @name handleCODEChange
     * @param {int} value
     * @module EmailVerify
     */
  const handleCODEChange = (value) => {
    setCODE(value);
  };
  /**
     * Used to create the userObject with all the data needed for sign up as well as making a request for the backend to send a verification code to the user's email
     * @function useEffect
     * @name useEffect
     * 
     */
  useEffect(() => {
    const Name = JSON.parse(localStorage.getItem("Name"));
    const Email = JSON.parse(localStorage.getItem("Email"));
    const phone = JSON.parse(localStorage.getItem("PhoneNumber"));
    const Username = JSON.parse(localStorage.getItem("Username"));

    let userObject = {
      email: Email,
      username: Username,
      name: Name,
      gender: props.gender,
      birth_date: props.birth,
    };

    console.log(userObject);

    if (phone.length !== 0) {
      userObject["phone_number"] = phone;
    }

    axios
      .post("/auth/signup", userObject, {
        headers: { "Content-Type": "application/json" },
      })
      .then((response) => {
        console.log(response);
        if (response.status === 200) {
          localStorage.setItem("user", JSON.stringify(response.data.user));
        }
      })
      .catch((err) => { });
  }, []);

  const [alert, setAlert] = useState(true);

  /**
     * Used to see if the button is clicked or not. If clicked, val is true.
     * @function handleClick
     * @name handleClick
     * @param {boolean} val
     */
  const handleClick = (val) => {
    props.handleButtonClick(val);
    setAlert(val);
  };
  /**
     * Handles resending the verification code to the user's email in case he didn't receive an email automatically.
     * @function ResendHandler
     * @name ResendHandler
     */
  const ResendHandler = () => {
    const Email = JSON.parse(localStorage.getItem("Email"));

    let userObject = {
      email_or_username: Email,
    };
    axios
      .post("/auth/resend-verification", userObject, {
        headers: { "Content-Type": "application/json" },
      })
      .then((response) => {
        console.log(response);
        if (response.status === 200) {
          localStorage.setItem("UserInfo", JSON.stringify(response.data.user));
        }
      })
      .catch((err) => { });
  };
  //Use above for day month and year to gain their value
  useEffect(() => {
    setTimeout(() => {
      setAlert(true);
    }, 5000);
  }, [alert]);
  return (
    &lt;div>
      &lt;img
        className={classes.twitterBluelogo}
        src={twitterBlueLogo}
        alt="TwitterLogo"
      />
      &lt;NavLink to="/" className={classes.closeIcon}>
        &lt;ClearIcon />
      &lt;/NavLink>

      &lt;div className={classes.container}>
        &lt;div className={classes.Minor}>
          &lt;p>We sent you a code&lt;/p>
        &lt;/div>
        &lt;div className={classes.Minor3}>
          Enter it below to verify your email.
        &lt;/div>
        &lt;InputField
          label="Verification Code"
          disable={false}
          itemName="VerificationCode"
          maxLength={50}
          passData={handleCODEChange}
        />
        &lt;div className={classes.Minor4} onClick={ResendHandler}>
          Didn't receive email?
        &lt;/div>
        &lt;div className={classes.NextButton}>
          &lt;SignUp handleButtonClick={handleClick} />
        &lt;/div>
      &lt;/div>
      {!alert &amp;&amp; (
        &lt;div className={classes.alert}>
          &lt;Alert message="Invalid. Please enter the verification code you received." />
        &lt;/div>
      )}
    &lt;/div>
  );
};

export default Verify;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-EmailVerify.html">EmailVerify</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Wed May 25 2022 02:09:24 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
