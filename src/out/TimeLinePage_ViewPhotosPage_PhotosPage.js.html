<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: TimeLinePage/ViewPhotosPage/PhotosPage.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: TimeLinePage/ViewPhotosPage/PhotosPage.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState } from "react";
import { Button } from "react-bootstrap";
import { useParams } from "react-router-dom/cjs/react-router-dom.min";
import classes from "./PhotosPage.module.css";
import instance from "../../axios";
import ReactLoading from "react-loading";
import TweetAndReplies from "../TweetPage/TweetAndReplies";
import ArrowBackOutlinedIcon from "@material-ui/icons/ArrowBackOutlined";
import ArrowForwardOutlinedIcon from "@material-ui/icons/ArrowForwardOutlined";
import DoubleArrowIcon from '@material-ui/icons/DoubleArrow';
import CloseIcon from '@material-ui/icons/Close';
import TweetAtrribute from "../MiddlePage/TweetAtrribute";

import ChatBubbleOutlineOutlinedIcon from "@material-ui/icons/ChatBubbleOutlineOutlined";
import LoopOutlinedIcon from "@material-ui/icons/LoopOutlined";
import FavoriteBorderOutlinedIcon from "@material-ui/icons/FavoriteBorderOutlined";
import FavoriteIcon from "@material-ui/icons/Favorite";
import ShareOutlinedIcon from "@material-ui/icons/ShareOutlined";
import { keyboard } from "@testing-library/user-event/dist/keyboard";
import { useHistory } from "react-router-dom";
import axios from "axios";

/**
 * The page that displays when a photo is clicked
 * @param {String} tweetId to get the tweet and its replies
 */
function PhotosPage(props) {
  const [replyModal, setReplyModal] = useState(false);
  function viewReplyModal() {
    setReplyModal(true);
  }
  const [photos, setPhotos] = useState(null);
  let isMock = localStorage.getItem("isMock") === "true";
  const [isLoading, setLoading] = React.useState(true);
  let id;
  let photoNum ;
  const [currentPhoto, setCurrentPhoto] = useState(null);
  const [photosTweet, setPhotosTweet] = useState(null);
  const [sendTweet, setSendTweet] = useState(null);
  const [hidden, setHidden] = useState(localStorage.getItem("photosHidden") === "true");



  React.useEffect(() => {
    getTweet();
  }, [props.increment]);
  let tweet;
  async function getTweet() {
    id = window.location.pathname.split("/")[3]; 
    photoNum = parseInt(window.location.pathname.split("/")[5]);
    setCurrentPhoto(photoNum);
    setLoading(true);
    if (!isMock) {
      let res;
      res = props.testUrl ? await axios.get(props.testUrl) : await instance.get(`/status/tweet/${id}`);
      setPhotosTweet(res.data.tweet);
      tweet =photosTweet ? {
        content: photosTweet.content,
        dateCreated: photosTweet.created_at,
        likes: photosTweet.likes_count,
        retweets: photosTweet.retweets_count,
        replies: photosTweet.replies_count,
        id: photosTweet.id,
        userId: photosTweet.user.id,
      } : null;
      setPhotos(res.data.tweet.media);
    } else {
      await fetch(`http://localhost:3000/home/${id}`)
        .then((res) => res.json())
        .then((data) => {
          setPhotos(data.media);
          setPhotosTweet(data);
          tweet = {
            content: data.content,
            dateCreated: data.created_at,
            likes: data.likes_count,
            retweets: data.retweets_count,
            replies: data.replies_count,
            id: data.id,
            userId: data.user.id,
          };
          setSendTweet(tweet);
        });
    }
    setLoading(false);
  }

  function keyPress(e){
      if(e.keyCode === 37){
        if(currentPhoto > 1){
          setCurrentPhoto(currentPhoto - 1);
        }
      }
    if(e.keyCode === 39){
        if(currentPhoto &lt; photos.length){
            setCurrentPhoto(currentPhoto + 1);
            }
        }
    }
  return (
    &lt;div className={`${classes.flex} ${classes.photosPage}`} onKeyDown = {keyPress} tabIndex = "2" onClick ={() => {window.history.pushState("", "", `${props.prevPath}`); props.setPhotosActive(false); }}>
      &lt;div className={`${classes.photo}`} >
        {photos &amp;&amp; (
          &lt;div className={classes.flex}>
            &lt;div className={classes.leftArrows}>
                &lt;div className={`${classes.doubleArrow} ${classes.left}`} onClick ={() => {window.history.pushState("", "", `${props.prevPath}`); props.setPhotosActive(false); }}> &lt;CloseIcon className={classes.icon}/> &lt;/div>
                {currentPhoto > 1 &amp;&amp; (
                &lt;div
                    className={`${classes.arrow} ${classes.back} ${classes.left}`}
                    onClick={(e) => {
                      e.stopPropagation();
                      setCurrentPhoto((prevNum) => prevNum - 1);
                    }}
                >
                    &lt;ArrowBackOutlinedIcon className={classes.icon}/>
                &lt;/div>
                )}
            &lt;/div>
            &lt;img
              className={classes.image}
              src={photos[currentPhoto - 1]}
              alt=""
              onClick = {(e) => e.stopPropagation()}
            />
            &lt;div className={`${!hidden &amp;&amp; classes.rightArrows} ${hidden &amp;&amp; classes.rightHidden}`}>
            &lt;div className={`${classes.doubleArrow} ${hidden &amp;&amp; classes.rotate} ${classes.push}`} 
            onClick ={(e) => {
              e.stopPropagation();
              setHidden(prev => !prev); 
              localStorage.setItem("photosHidden",hidden ? "false" : "true")}}> &lt;DoubleArrowIcon className={classes.icon}/> &lt;/div>

            {currentPhoto &lt; photos.length &amp;&amp; (
              &lt;div
                data-testid="next-photo"
                className={`${classes.arrow} ${classes.forward}`}
                onClick={(e) => {
                  e.stopPropagation();
                  setCurrentPhoto((prevNum) => prevNum + 1);
                }}>
                &lt;ArrowForwardOutlinedIcon className={classes.icon}/>
              &lt;/div>
            )}
            &lt;/div>
          &lt;/div>
          
        )}
        {photosTweet &amp;&amp; (
          &lt;div id="FeedTweetAttributes" className={classes.attributes}>
            &lt;TweetAtrribute
              Icon={ChatBubbleOutlineOutlinedIcon}
              num={photosTweet.replies_count}
              color="b"
              textColor = "white"
              tooltip="Reply"
              onClick={viewReplyModal}
              tweet={sendTweet}
            />
            &lt;TweetAtrribute
              Icon={LoopOutlinedIcon}
              num={photosTweet.retweets_count}
              color="g"
              textColor = "white"
              tooltip="Retweet"
              isRetweeted={photosTweet.is_retweeted}
              tweet={sendTweet}
            />
            &lt;TweetAtrribute
              Icon={FavoriteBorderOutlinedIcon}
              FilledIcon={FavoriteIcon}
              num={photosTweet.likes_count}
              color="r"
              textColor = "white"
              tooltip="Like"
              isLiked={photosTweet.is_liked}
              tweet={sendTweet}
            />
            &lt;TweetAtrribute
              isLiked={photosTweet.is_liked}
              isRetweeted={photosTweet.is_retweeted}
              Icon={ShareOutlinedIcon}
              color="b"
              textColor = "white"
              tooltip="Share"
              tweet={sendTweet}
            />
          &lt;/div>
        )}
      &lt;/div>
      &lt;div className={`${classes.tweetsAndReplies} ${hidden &amp;&amp; classes.none}`} onClick = {(e) => e.stopPropagation()}>
        &lt;TweetAndReplies isShowPhotos={true} setPhotosActive = {props.setPhotosActive} setIncrement = {props.setIncrement} increment = {props.increment}/>
      &lt;/div>
      {isLoading &amp;&amp; (
        &lt;ReactLoading
          type={"spin"}
          color={"#1DA1F2"}
          height={"4%"}
          width={"4%"}
          className={`${classes.loadingIcon}`}
        />
      )}
    &lt;/div>
  );
}

export default PhotosPage;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#AccountButton">AccountButton</a></li><li><a href="global.html#DeleteModal">DeleteModal</a></li><li><a href="global.html#ImageGrid">ImageGrid</a></li><li><a href="global.html#LeftSideBar">LeftSideBar</a></li><li><a href="global.html#MiniProfile">MiniProfile</a></li><li><a href="global.html#MoreButton">MoreButton</a></li><li><a href="global.html#PhotosPage">PhotosPage</a></li><li><a href="global.html#rotateSize">rotateSize</a></li><li><a href="global.html#TweetAndReplies">TweetAndReplies</a></li><li><a href="global.html#TweetAtrribute">TweetAtrribute</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue May 24 2022 20:05:32 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
