<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: TimeLinePage/MiddlePage/TweetAtrribute.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: TimeLinePage/MiddlePage/TweetAtrribute.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { useState } from "react";
import classes from "./TweetAtrribute.module.css";
import feedBoxButtonClasses from "./FeedBoxButton.module.css";
// import axios from "axios";
import instance from "../../axios";
import ErrorModal from "../BanModal/ErrorModal";
/**
 * The attributes at the bottom of the tweet.
 * 
 * @param  {String} tooltip the tooltip text also used to determine which attribute to render
 * @param  {Integer} num the number of the attribute (how many likes, retweets or replies)
 */
function TweetAtrribute(props) {
  const [clicked, setClicked] = React.useState("");
  const [num, setNum] = React.useState(props.num);
  const [hlLike, setHlLike] = React.useState(false);

  const [banned, setBanned] = useState(false);
  const handleOpenModal = (val) => {
    setBanned(val);
  };

  let isMock = localStorage.getItem("isMock") === "true";

  React.useEffect(() => {
    if (props.tooltip === "Like" &amp;&amp; props.isLiked) {
      setHlLike(true);
      setClicked(classes.clicked);
    }
    if (props.tooltip === "Retweet" &amp;&amp; props.isRetweeted) {
      setClicked(classes.clicked);
    }
  }, []);

  const white =
    props.textColor &amp;&amp; props.textColor === "white" ? classes.white : "";

  //console.log(props.tweet);
  function click() {
    if (props.tooltip === "Like" || props.tooltip === "Retweet") {
      if (props.tooltip === "Like") {
        setHlLike((prevhlLike) => {
          return !prevhlLike;
        });
        if (clicked === classes.clicked) {
          if (!isMock) {
            instance.delete("/status/unlike", {
              data: {
                id: props.tweet.id,
              },
            });
          } else {
            fetch(`http://localhost:3000/home/${props.tweet.id}`, {
              method: "PATCH",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                likes_count: num - 1,
                is_liked: false,
              }),
            });
            fetch(`http://localhost:3000/replies/${props.tweet.id}`, {
              method: "PATCH",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                likes_count: num - 1,
                is_liked: false,
              }),
            });
          }
        } else {
          if (!isMock) instance.post("/status/like", { id: props.tweet.id });
          else {
            fetch(`http://localhost:3000/home/${props.tweet.id}`, {
              method: "PATCH",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                likes_count: num + 1,
                is_liked: true,
              }),
            });
            fetch(`http://localhost:3000/replies/${props.tweet.id}`, {
              method: "PATCH",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                likes_count: num + 1,
                is_liked: true,
              }),
            });
          }
        }
        //console.log(props.tweet.likes);
      } else {
        if (clicked === classes.clicked) {
          // props.tweet.retweets -= 1;
          instance.delete("/status/unretweet", {
            data: {
              id: props.tweet.id,
            },
          });
        } else {
          // props.tweet.retweets += 1;
          const isBanned = JSON.parse(localStorage.getItem("UserInfo")).isBanned;
          if (isBanned === true) {
            setBanned(true);
            return;
          }
          instance.post("/status/retweet", { id: props.tweet.id });
        }
      }
      setNum((prevNum) => {
        return clicked === classes.clicked ? prevNum - 1 : prevNum + 1;
      });
      setClicked((prevClicked) => {
        return prevClicked === classes.clicked ? "" : classes.clicked;
      });
      //console.log(props.tweet);
      //const resp = api.put(`users/${props.tweet.userId}/tweet/${props.tweet.id}`, props.tweet);
    } else if (props.tooltip === "Reply") {
      props.onClick();
    }
  }

  return (
    &lt;>
      &lt;div
        className={`${classes.tweetAtrribute} ${classes[props.color]
          } ${clicked} ${white}`}
        onClick={(e) => {
          e.stopPropagation();
        }}
      >
        &lt;div onClick={click} className={feedBoxButtonClasses.tooltip}>
          &lt;div className={classes.flex}>
            {!hlLike &amp;&amp; &lt;props.Icon className={classes.attIcon} />}
            {hlLike &amp;&amp; &lt;props.FilledIcon className={classes.attIcon} />}
            &lt;p className={classes.num}>{num}&lt;/p>
          &lt;/div>
          &lt;span className={feedBoxButtonClasses.tooltiptext}>
            {props.tooltip}
          &lt;/span>
        &lt;/div>
      &lt;/div>
      &lt;div onClick={(e) => e.stopPropagation()}>
        {banned &amp;&amp; (
          &lt;ErrorModal
            message="You are Banned."
            open={banned}
            setOpenModalValue={handleOpenModal}
          />
        )}
      &lt;/div>
    &lt;/>
  );
}

export default TweetAtrribute;
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#AccountButton">AccountButton</a></li><li><a href="global.html#DeleteModal">DeleteModal</a></li><li><a href="global.html#ImageGrid">ImageGrid</a></li><li><a href="global.html#LeftSideBar">LeftSideBar</a></li><li><a href="global.html#MiniProfile">MiniProfile</a></li><li><a href="global.html#MoreButton">MoreButton</a></li><li><a href="global.html#PhotosPage">PhotosPage</a></li><li><a href="global.html#rotateSize">rotateSize</a></li><li><a href="global.html#TweetAndReplies">TweetAndReplies</a></li><li><a href="global.html#TweetAtrribute">TweetAtrribute</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a> on Tue May 24 2022 20:05:32 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
